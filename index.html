<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Financial accounting</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Icons and Colors -->
<link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
<link rel="manifest" href="./manifest.json">
<link rel="mask-icon" href="./safari-pinned-tab.svg" color="#000000">
<link rel="shortcut icon" href="./favicon.ico">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="./mstile-144x144.png">
<meta name="msapplication-config" content="./browserconfig.xml">
<meta name="theme-color" content="#000000">

<!-- Styles -->
<link rel="stylesheet" href="style.css">


</head>

<body>

<header>
	<div class="header-container-div">
		<div class="logo-hello-div">
			<div class="logo">
				<a href="/">
					<img src="Logo.png" width="60" height="60px" />
				</a>
			</div>
			<p class="hello-text-p">Привет,  <p id="user-name-id-p" class="user-name-p">%username%!</p></p>
		</div>
		<div class="menu">
			<ul class="ul-menu">
				<li><a href="#balance-block">Баланс</a></li>
				<li><a href="#income-and-expenses-block">Операции</a></li>
				<li><a href="#limits-block">Лимиты</a></li>
				<li><a id="sign-in-a" href="#sign-in-up-modal">Вход</a></li>
				<li><a id="sign-out-a" href="#sign-in-up-modal">Выход</a></li>
			</ul>
		</div>
	</div>
</header>

<div class="main-container">
	<div id="balance-block" class="balance-div">
		<p class="balance-text-p">Баланс:</p>
		<p class="balance-number-p">20 000</p>
	</div>
	<div id="income-and-expenses-block" class="income-and-expenses-div">
		<div class="income-div">
			<p class="income-text-p">Доходы в этом месяце:</p>
			<p class="income-number-p">0</p>
		</div>
		<div class="expenses-div">
			<p class="expenses-text-p">Расходы в этом месяце:</p>
			<p class="expenses-number-p">0</p>
		</div>
	</div>
	<div class="adding-buttons-income-and-expenses-div">
		<input type="button" name="add-income-input" value="Добавить доход" />
		<input type="button" name="add-expenses-input" value="Добавить расход" />
	</div>
	<div id="limits-block" class="recent-operations-div">
		<p class="recent-operations-text-p">Последние операции в этом месяце:</p>
	</div>
	<div class="limits-div">
		limits-div

	</div>

	<div id="sign-in-up-modal" class="modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h3 id="authentication-title-h3" class="modal-title">Вход</h3>
					<a href="#close" title="Close" class="close">×</a>
				</div>
				<div class="modal-body">
					<div id="sign-in-form-div-id" class="sign-in-form-div">
						<form action="enter.php" id="form-block" method="post">
							<input type="text" name="login-signin-input" placeholder="Логин"/>
							<input type="password" name="password-signin-input" placeholder="Пароль"/>
							<button type="submit">Войти</button>
							<button type="button" onclick="moveToSignUp()">Еще не зарегестрированы?</button>
						</form>
					</div>

					<div id="sign-up-form-div-id" class="sign-up-form-div">
						<form action="registration.php" id="form-block" method="post">
							<input type="text" name="login-input" placeholder="Логин"/>
							<input type="email" name="email-input" placeholder="Почта"/>
							<input type="text" name="name-input" placeholder="Имя"/>
							<input type="password" name="password-input" placeholder="Пароль"/>
							<button type="submit">Зарегистрироваться</button>
							<button type="button" onclick="moveToSignIn()">Уже есть учетная запись?</button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Javscript -->
<script>
	if ("serviceWorker" in navigator) {
		window.addEventListener("load", () => {
			navigator.serviceWorker && navigator.serviceWorker.register("./sw.js");
		});
	}
	function moveToSignUp() {
		document.getElementById('sign-up-form-div-id').style.display = "flex"; //Показываем элемент
		document.getElementById('sign-in-form-div-id').style.display = "none"; //Показываем элемент
		document.getElementById('authentication-title-h3').textContent = "Регистрация"; //Показываем элемент

	}
	function moveToSignIn() {
		document.getElementById('sign-in-form-div-id').style.display = "flex"; //Показываем элемент
		document.getElementById('sign-up-form-div-id').style.display = "none"; //Показываем элемент
		document.getElementById('authentication-title-h3').textContent = "Вход"; //Показываем элемент

	}

	// Функция для отправки данных о пользователе
	let xhrData = new XMLHttpRequest(); // Создаем новый объект XMLHttpRequest
	let userName = document.getElementById('user-name-id-p');
	xhrData.onreadystatechange = function() // Устанавливаем функцию, которая будет вызываться при изменении состояния объекта `xhr`
	{
		if (xhrData.readyState === 4 && xhrData.status === 200) // Проверяем, что запрос завершен и успешен
		{
			if (xhrData.responseText)
			{
				let userData = JSON.parse(xhrData.responseText);
				userName.textContent = userData[0];
				document.getElementById('sign-in-a').style.display = "none";
				document.getElementById('sign-out-a').style.display = "block";
			}
		}
	};
	xhrData.open("POST", "user-data.php"); // Открываем соединение с сервером с помощью метода "POST" и адреса "cards.php"
	xhrData.send(); // Отправляем запрос на сервер

	// Функция для обработки кнопки выход
	let exit = document.getElementById("sign-out-a");
	exit.onclick = function()
	{
		document.getElementById('sign-in-a').style.display = "block";
		document.getElementById('sign-out-a').style.display = "none";
		let xhr = new XMLHttpRequest();
		xhr.open('POST', 'exit.php', false); // Установлен параметр async в false
		xhr.send();
	}
</script>
<script src="main.js"></script>
</body>

</html>


